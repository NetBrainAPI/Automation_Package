{
    "_id": "b29c13e5-70d6-d437-8618-2c204a48b4e1",
    "author": "NetBrain",
    "bizType": "CLI",
    "command": "show mac address-table",
    "createTime": {
        "$date": 1580492812785
    },
    "description": "Device Type:\nCisco IOS Switch\nCisco Router\nCommand: \n       show mac address-table",
    "devTypes": [
        2001,
        2
    ],
    "params": [],
    "qualify": null,
    "retrieveScript": "",
    "samples": [
        {
            "content": "qapp-c3560-1>show mac address-table\r\n          Mac Address Table\r\n-------------------------------------------\r\n\r\nVlan    Mac Address       Type        Ports\r\n----    -----------       --------    -----\r\n All    0100.0ccc.cccc    STATIC      CPU\r\n All    0100.0ccc.cccd    STATIC      CPU\r\n All    0180.c200.0000    STATIC      CPU\r\n All    0180.c200.0001    STATIC      CPU\r\n All    0180.c200.0002    STATIC      CPU\r\n All    0180.c200.0003    STATIC      CPU\r\n All    0180.c200.0004    STATIC      CPU\r\n All    0180.c200.0005    STATIC      CPU\r\n All    0180.c200.0006    STATIC      CPU\r\n All    0180.c200.0007    STATIC      CPU\r\n All    0180.c200.0008    STATIC      CPU\r\n All    0180.c200.0009    STATIC      CPU\r\n All    0180.c200.000a    STATIC      CPU\r\n All    0180.c200.000b    STATIC      CPU\r\n All    0180.c200.000c    STATIC      CPU\r\n All    0180.c200.000d    STATIC      CPU\r\n All    0180.c200.000e    STATIC      CPU\r\n All    0180.c200.000f    STATIC      CPU\r\n All    0180.c200.0010    STATIC      CPU\r\n All    ffff.ffff.ffff    STATIC      CPU\r\n  50    000c.2916.7a32    DYNAMIC     Gi0/24\r\n  50    000c.292c.4ac5    DYNAMIC     Gi0/24\r\n  50    000c.294b.8867    DYNAMIC     Gi0/24\r\n  50    000c.2962.2b19    DYNAMIC     Gi0/24\r\n  50    000c.2991.af2a    DYNAMIC     Gi0/24\r\n  50    000c.29a9.3048    DYNAMIC     Gi0/24\r\n  50    000c.29c4.aaf4    DYNAMIC     Gi0/24\r\n  50    000c.29f4.5af7    DYNAMIC     Gi0/24\r\n  50    000c.29ff.61b2    DYNAMIC     Gi0/24\r\n  50    000e.c6d7.d30e    DYNAMIC     Gi0/24\r\n  50    0050.56c0.0000    DYNAMIC     Gi0/24\r\n  50    1c39.4728.a916    DYNAMIC     Gi0/24\r\n  50    1c39.4730.8a9e    DYNAMIC     Gi0/24\r\n  50    1c39.47b2.7eaf    DYNAMIC     Gi0/24\r\n  50    3417.ebd0.97e6    DYNAMIC     Gi0/24\r\n  50    3417.ebdf.b621    DYNAMIC     Gi0/24\r\n  50    44a8.4217.3ea2    DYNAMIC     Gi0/24\r\n  50    5404.a6b4.0cea    DYNAMIC     Gi0/24\r\n  50    6400.6a82.ca4c    DYNAMIC     Gi0/24\r\n  50    689c.e2d7.5517    DYNAMIC     Gi0/24\r\n  50    9810.e8f1.4abf    DYNAMIC     Gi0/24\r\n  50    9890.96ca.814c    DYNAMIC     Gi0/24\r\n  50    9890.96ca.b8e1    DYNAMIC     Gi0/24\r\n  50    9890.96d7.0b51    DYNAMIC     Gi0/24\r\n  50    a860.b639.9dc5    DYNAMIC     Gi0/24\r\n  50    b8ca.3a9c.cf83    DYNAMIC     Gi0/24\r\n  50    ca01.190c.0008    DYNAMIC     Gi0/24\r\n  50    ca03.1fec.0008    DYNAMIC     Gi0/24\r\n  50    d072.dc91.72e7    DYNAMIC     Gi0/24\r\n  50    f48e.38a8.01cb    DYNAMIC     Gi0/24\r\n  50    f8b1.569f.12fe    DYNAMIC     Gi0/24\r\n 400    0023.5deb.948d    DYNAMIC     Gi0/13\r\n 400    0023.5deb.948e    DYNAMIC     Gi0/14\r\n 103    000b.866e.057c    DYNAMIC     Gi0/23\r\n 103    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 104    000b.866e.057c    DYNAMIC     Gi0/23\r\n 104    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 104    84d4.7ec2.cc6a    DYNAMIC     Gi0/6\r\n   1    0000.5e00.010a    DYNAMIC     Gi0/2\r\n   1    000b.866e.057c    DYNAMIC     Gi0/23\r\n   1    0023.5deb.9497    DYNAMIC     Gi0/23\r\n   1    0023.5deb.94c0    DYNAMIC     Gi0/23\r\n   1    1864.72cd.8eca    DYNAMIC     Gi0/12\r\n   1    f8b1.5636.0376    DYNAMIC     Gi0/2\r\n  10    0000.5e00.010a    DYNAMIC     Gi0/19\r\n  10    0001.e8d6.5d9f    DYNAMIC     Gi0/19\r\n  10    0023.5deb.9493    DYNAMIC     Gi0/19\r\n  10    0023.5deb.94c4    DYNAMIC     Gi0/19\r\n 100    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 100    0023.5deb.94c5    DYNAMIC     Gi0/23\r\n 200    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 300    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 443    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 601    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 602    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 603    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 604    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 605    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 606    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 607    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 608    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 609    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 610    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 611    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 612    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 613    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 614    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 615    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 616    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 617    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 618    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 619    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 620    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 621    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 622    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 623    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 624    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 625    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 626    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 627    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 628    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 629    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 630    0023.5deb.9497    DYNAMIC     Gi0/23\r\n 631    0023.5deb.9497    DYNAMIC     Gi0/23\r\nTotal Mac Addresses for this criterion: 104\r\n\r\n",
            "devName": "",
            "identify": "{\"ConfigKey\":{\"MustConditions\":{\"Item\":[]},\"OptionalConditions\":{\"Item\":[]}}}",
            "index": 1,
            "interfaceKeys": [
                "_original_result.vlan_table.$ports",
                "_original_result.intf_summary.$interface"
            ],
            "keyWords": "{\"keyWords\":[]}",
            "name": "sample1",
            "parserRules": "{\"parseRule\":[{\"type\":\"8\",\"script\":\"import re\\r\\n\\r\\ndef ParseText(_original_result):\\r\\n    config = _original_result\\r\\n\\r\\n    dic = {\\r\\n        'vlan_table': {'vlan':[], 'mac_address':[], 'type':[], 'ports':[], '$_columns':['vlan', 'mac_address', 'type', 'ports']},\\r\\n        'intf_summary': {'interface':[], 'mac_counts':[], '$_columns':['interface', 'mac_counts']}\\r\\n    }\\r\\n\\r\\n    vlan_table_lst = re.compile(r'^\\\\s*(\\\\S+)[ ]+(\\\\S+\\\\.\\\\S+\\\\.\\\\S+)[ ]+(\\\\S+)[ ]+(\\\\S+)', re.M).findall(config) \\r\\n\\r\\n    intf_sum_dict = {}\\r\\n\\r\\n    for vlan_obj in vlan_table_lst:\\r\\n        vlan_id = vlan_obj[0]\\r\\n        mac_addr = vlan_obj[1]\\r\\n        vlan_type = vlan_obj[2]\\r\\n        ports = vlan_obj[3]\\r\\n\\r\\n        if 'cpu' not in ports.lower():\\r\\n            vlan_dict = dic['vlan_table']\\r\\n            vlan_dict['vlan'].append(vlan_id)\\r\\n            vlan_dict['mac_address'].append(mac_addr)\\r\\n            vlan_dict['type'].append(vlan_type)\\r\\n            vlan_dict['ports'].append(ports)\\r\\n            if ports not in intf_sum_dict:\\r\\n                intf_sum_dict[ports] = 1\\r\\n            else:\\r\\n                intf_sum_dict[ports] += 1\\r\\n    if intf_sum_dict:\\r\\n        dic['intf_summary']['interface'] = sorted(intf_sum_dict)\\r\\n        dic['intf_summary']['mac_counts'] = [intf_sum_dict[key] for key in sorted(intf_sum_dict)]\\r\\n\\r\\n    return dic\\r\\n\",\"variableTypes\":{\"variableType\":[]},\"tableVariableTypes\":{\"tableVariableType\":[{\"name\":\"$intf_summary\",\"variableTypes\":{\"variableType\":[{\"name\":\"$interface\",\"type\":\"string\"},{\"name\":\"$mac_counts\",\"type\":\"int\"}]}},{\"name\":\"$vlan_table\",\"variableTypes\":{\"variableType\":[{\"name\":\"$vlan\",\"type\":\"string\"},{\"name\":\"$mac_address\",\"type\":\"string\"},{\"name\":\"$type\",\"type\":\"string\"},{\"name\":\"$ports\",\"type\":\"string\"}]}}]},\"name\":\"\",\"xxid\":\"79380536-fe6c-8cdb-3131-d48276c974c2\",\"interfaceKey\":{\"vlan_table\":\"$ports\",\"intf_summary\":\"$interface\"},\"hashColumns\":{\"intf_summary\":[\"$intf\",\"$interface\"],\"vlan_table\":[\"$ports\"]}},{\"type\":\"0\",\"keyWords\":{\"keyWord\":[\"mregex[$cli_output]:(.+)\"]},\"statements\":[],\"variableTypes\":{\"variableType\":[\"$cli_output:string\"]},\"xxid\":\"1cc954c7-b159-96c3-7183-21570d8adaaf\"}]}",
            "tableKeys": []
        }
    ],
    "schemaList": null,
    "sequences": [
        1
    ],
    "structure": {
        "name": null,
        "structure": [
            {
                "hashSort": false,
                "index": 0,
                "name": "cli_output",
                "type": 4
            },
            {
                "attributes": [
                    {
                        "index": 2,
                        "name": "_rowCount",
                        "type": 1
                    },
                    {
                        "index": 3,
                        "name": "_hashCmp",
                        "type": 4
                    }
                ],
                "column": [
                    {
                        "index": 0,
                        "name": "interface",
                        "type": 4
                    },
                    {
                        "index": 1,
                        "name": "mac_counts",
                        "type": 1
                    }
                ],
                "hashColumns": [
                    "interface",
                    "intf"
                ],
                "hashSort": false,
                "index": 1,
                "name": "intf_summary",
                "type": 11
            },
            {
                "attributes": [
                    {
                        "index": 4,
                        "name": "_rowCount",
                        "type": 1
                    },
                    {
                        "index": 5,
                        "name": "_hashCmp",
                        "type": 4
                    }
                ],
                "column": [
                    {
                        "index": 0,
                        "name": "mac_address",
                        "type": 4
                    },
                    {
                        "index": 1,
                        "name": "ports",
                        "type": 4
                    },
                    {
                        "index": 2,
                        "name": "type",
                        "type": 4
                    },
                    {
                        "index": 3,
                        "name": "vlan",
                        "type": 4
                    }
                ],
                "hashColumns": [
                    "ports"
                ],
                "hashSort": false,
                "index": 2,
                "name": "vlan_table",
                "type": 11
            }
        ]
    },
    "structureId": "1c83eeaf3f7369a0a1284bd01ea5278a",
    "supportNodeType": 0,
    "type": 1,
    "variables": [
        {
            "capName": "$intf_summary",
            "dataType": "table",
            "desc": "Interface summary.",
            "extraInfo": {
                "hashColumns": [
                    "$intf",
                    "$interface"
                ],
                "hashSort": false
            },
            "fullName": "$intf_summary",
            "intfKey": false,
            "name": "$intf_summary",
            "realType": null,
            "sampleIndex": 1,
            "varType": 4
        },
        {
            "capName": "$intf_summary.$interface",
            "dataType": "string",
            "desc": "",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$intf_summary.$interface",
            "intfKey": false,
            "name": "$interface",
            "realType": null,
            "sampleIndex": 1,
            "varType": 2
        },
        {
            "capName": "$intf_summary.$mac_counts",
            "dataType": "int",
            "desc": "Mac counts.",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$intf_summary.$mac_counts",
            "intfKey": false,
            "name": "$mac_counts",
            "realType": null,
            "sampleIndex": 1,
            "varType": 1
        },
        {
            "capName": "$vlan_table",
            "dataType": "table",
            "desc": "Vlan table.",
            "extraInfo": {
                "hashColumns": [
                    "$ports"
                ],
                "hashSort": false
            },
            "fullName": "$vlan_table",
            "intfKey": false,
            "name": "$vlan_table",
            "realType": null,
            "sampleIndex": 1,
            "varType": 4
        },
        {
            "capName": "$vlan_table.$vlan",
            "dataType": "string",
            "desc": "VLAN ID.",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$vlan_table.$vlan",
            "intfKey": false,
            "name": "$vlan",
            "realType": null,
            "sampleIndex": 1,
            "varType": 1
        },
        {
            "capName": "$vlan_table.$mac_address",
            "dataType": "string",
            "desc": "",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$vlan_table.$mac_address",
            "intfKey": false,
            "name": "$mac_address",
            "realType": null,
            "sampleIndex": 1,
            "varType": 1
        },
        {
            "capName": "$vlan_table.$type",
            "dataType": "string",
            "desc": "Type.",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$vlan_table.$type",
            "intfKey": false,
            "name": "$type",
            "realType": null,
            "sampleIndex": 1,
            "varType": 1
        },
        {
            "capName": "$vlan_table.$ports",
            "dataType": "string",
            "desc": "Ports.",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$vlan_table.$ports",
            "intfKey": false,
            "name": "$ports",
            "realType": null,
            "sampleIndex": 1,
            "varType": 2
        },
        {
            "capName": "$cli_output",
            "dataType": "string",
            "desc": "",
            "extraInfo": {
                "hashColumns": [],
                "hashSort": false
            },
            "fullName": "$cli_output",
            "intfKey": false,
            "name": "$cli_output",
            "realType": null,
            "sampleIndex": 1,
            "varType": 1
        }
    ],
    "version": "7.1"
}